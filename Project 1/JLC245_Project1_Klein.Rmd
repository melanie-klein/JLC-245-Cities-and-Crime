---
title: "JLC-245 Project 1"
author: "Melanie Klein"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r libraries, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(GGally)
```

```{r load data, message=FALSE, warning=FALSE, include=FALSE}
dc.data2025 <- read.csv("https://opendata.arcgis.com/datasets/74d924ddc3374e3b977e6f002478cb9b_7.csv", stringsAsFactors = FALSE) 
dc.data2024 <- read.csv("https://opendata.arcgis.com/datasets/c5a9f33ffca546babbd91de1969e742d_6.csv", stringsAsFactors = FALSE)
dc.data2023 <- read.csv("https://opendata.arcgis.com/datasets/89561a4f02ba46cca3c42333425d1b87_5.csv", stringsAsFactors = FALSE)
dc.data2022 <- read.csv("https://opendata.arcgis.com/datasets/f9cc541fc8c04106a05a1a4f1e7e813c_4.csv", stringsAsFactors = FALSE)
dc.data2021 <- read.csv("https://opendata.arcgis.com/datasets/619c5bd17ca2411db0689bb0a211783c_3.csv", stringsAsFactors = FALSE)
dc.data2020 <- read.csv("https://opendata.arcgis.com/datasets/f516e0dd7b614b088ad781b0c4002331_2.csv", stringsAsFactors = FALSE)
dc.data2019 <- read.csv("https://opendata.arcgis.com/datasets/f08294e5286141c293e9202fcd3e8b57_1.csv", stringsAsFactors = FALSE)
dc.data2018 <- read.csv("https://opendata.arcgis.com/datasets/38ba41dd74354563bce28a359b59324e_0.csv", stringsAsFactors = FALSE)
dc.data2017 <- read.csv("https://opendata.arcgis.com/datasets/6af5cb8dc38e4bcbac8168b27ee104aa_38.csv", stringsAsFactors = FALSE)
dc.data2016 <- read.csv("https://opendata.arcgis.com/datasets/bda20763840448b58f8383bae800a843_26.csv", stringsAsFactors = FALSE)
dc.data2015 <- read.csv("https://opendata.arcgis.com/datasets/35034fcb3b36499c84c94c069ab1a966_27.csv", stringsAsFactors = FALSE)
dc.data2014 <- read.csv("https://opendata.arcgis.com/datasets/6eaf3e9713de44d3aa103622d51053b5_9.csv", stringsAsFactors = FALSE)
dc.data2013 <- read.csv("https://opendata.arcgis.com/datasets/5fa2e43557f7484d89aac9e1e76158c9_10.csv", stringsAsFactors = FALSE)
dc.data2012 <- read.csv("https://opendata.arcgis.com/datasets/010ac88c55b1409bb67c9270c8fc18b5_11.csv", stringsAsFactors = FALSE)
dc.data2011 <- read.csv("https://opendata.arcgis.com/datasets/9d5485ffae914c5f97047a7dd86e115b_35.csv", stringsAsFactors = FALSE)
dc.data2010 <- read.csv("https://opendata.arcgis.com/datasets/fdacfbdda7654e06a161352247d3a2f0_34.csv", stringsAsFactors = FALSE)
dc.data2009 <- read.csv("https://opendata.arcgis.com/datasets/73cd2f2858714cd1a7e2859f8e6e4de4_33.csv", stringsAsFactors = FALSE)
dc.data2008 <- read.csv("https://opendata.arcgis.com/datasets/180d56a1551c4e76ac2175e63dc0dce9_32.csv", stringsAsFactors = FALSE)
```

```{r merge data, message=FALSE, warning=FALSE, include=FALSE}
data.temp <- rbind(dc.data2008, dc.data2009, dc.data2010, dc.data2011, dc.data2012, dc.data2013, dc.data2014, dc.data2015, dc.data2016, dc.data2017, dc.data2018, dc.data2019, dc.data2020, dc.data2021, dc.data2022, dc.data2023, dc.data2024, dc.data2025)
```

```{r clean and create data, message=FALSE, warning=FALSE, include=FALSE}
dc.data <- separate(data.temp, REPORT_DAT, into = c("date", "time"), sep = " ")
dc.data$date <- as.Date(dc.data$date, format = "%Y/%m/%d")
dc.data$hour <- substr(dc.data$time, 0, 2)
dc.data$hour <- as.numeric(dc.data$hour)
dc.data$dow <- weekdays(dc.data$date)
dc.data$week <- format(as.Date(dc.data$date), "%U")
dc.data$week <- as.numeric(dc.data$week)
dc.data$month <- months(dc.data$date)
dc.data$year <- substr(dc.data$date, 0, 4)
```

# Finding 1
The most crime incidents are typically recorded during the evening shift, followed by the day shift, and then the midnight shift. On weekdays, there are approximately 500 more crime incidents recorded per day during the day and evening shifts compared to weekends. Conversely, during the midnight shift, there are approximately 500 fewer crime incidents per day recorded on weekdays than on weekends. Given that many people stay out late on the weekends, it is likely that this contributed to the increase in crimes recorded during the midnight shift.

# Visual 1
```{r echo=FALSE, message=FALSE, warning=FALSE}
dc.data$dow <- factor(dc.data$dow, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))

ggplot(dc.data, aes(x = dow, fill = SHIFT)) + 
  geom_bar(stat = "count", position = position_dodge(width = 0.8), width = 0.7) + 
  theme_classic() +
  labs(
    title = "Crimes by Day of Week",
    x = "Day of Week",
    y = "Number of Crimes"
  ) +
  guides(fill = guide_legend(title = "Shift")) +
  theme(
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = element_line(),
    axis.ticks = element_blank()
  )
```

# Finding 2
The ranking of districts by crime prevalence remains consistent throughout the months of the year. Districts 2 and 3 consistently report the highest crime rates, with approximately 7,500 to 10,000 incidents from 2008 to the present, and show relatively greater crime activity from June to November. In contrast, District 7, which has the second-lowest crime rate after District 8 (which records almost no crimes), reports approximately 5,000 incidents from 2008 to present.

# Visual 2

```{r echo=FALSE, message=FALSE, warning=FALSE}
dc.data$DISTRICT <- factor(dc.data$DISTRICT, levels = 1:8)
dc.data$month <- factor(dc.data$month, levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))

ggplot(dc.data, aes(DISTRICT)) + 
  geom_bar(stat = "count") + 
  theme_classic() + 
  facet_wrap(~month) +
  labs(
    title = "Crimes by District",
    x = "District",
    y = "Number of Crimes") +
  scale_x_discrete(drop = FALSE) 
```

# Finding 3
From 2020 to 2022, crime in DC saw a significant decrease during the pandemic, dropping to below 30,000 incidents per year. However, in 2023, crime levels spiked slightly above pre-pandemic figures, reaching approximately 34,000 incidents. Notably, motor vehicle theft has risen sharply from 2020 to 2023, becoming the most common offense type in 2023. Given that many people were staying at home during the pandemic, it is likely that this contributed to the increase in property crimes like motor vehicle theft.

# Finding 4
The wards vary in both the the amount of crime that occurs and the most common method used. The most amount of crime from 2008 to present occurs in Ward 2 at over 100,000 incidents and the least amount of crime occurs in Ward 3 at just above 30,000 incidents. Interestingly, guns are the least used method in all of the wards except for Wards 5, 7, and 8 where it is the most common method.